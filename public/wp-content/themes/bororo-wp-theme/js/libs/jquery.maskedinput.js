!function(a){var b="input.mask",c=void 0!=window.orientation;a.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},dataName:"rawMaskFn"},a.fn.extend({caret:function(a,b){if(0!=this.length){if("number"==typeof a)return b="number"==typeof b?b:a,this.each(function(){if(this.setSelectionRange)this.setSelectionRange(a,b);else if(this.createTextRange){var c=this.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",a),c.select()}});if(this[0].setSelectionRange)a=this[0].selectionStart,b=this[0].selectionEnd;else if(document.selection&&document.selection.createRange){var c=document.selection.createRange();a=0-c.duplicate().moveStart("character",-1e5),b=a+c.text.length}return{begin:a,end:b}}},unmask:function(){return this.trigger("unmask")},mask:function(d,e){if(!d&&this.length>0){var f=a(this[0]);return f.data(a.mask.dataName)()}e=a.extend({placeholder:"_",completed:null},e);var g=a.mask.definitions,h=[],i=d.length,j=null,k=d.length;return a.each(d.split(""),function(a,b){"?"==b?(k--,i=a):g[b]?(h.push(new RegExp(g[b])),null==j&&(j=h.length-1)):h.push(null)}),this.trigger("unmask").each(function(){function n(a){for(;++a<=k&&!h[a];);return a}function o(a){for(;--a>=0&&!h[a];);return a}function p(a,b){if(!(0>a)){for(var c=a,d=n(b);k>c;c++)if(h[c]){if(!(k>d&&h[c].test(l[d])))break;l[c]=l[d],l[d]=e.placeholder,d=n(d)}u(),f.caret(Math.max(j,a))}}function q(a){for(var b=a,c=e.placeholder;k>b;b++)if(h[b]){var d=n(b),f=l[b];if(l[b]=c,!(k>d&&h[d].test(f)))break;c=f}}function r(a){var b=a.which;if(8==b||46==b||c&&127==b){var d=f.caret(),e=d.begin,g=d.end;return 0==g-e&&(e=46!=b?o(e):g=n(e-1),g=46==b?n(g):g),t(e,g),p(e,g-1),!1}return 27==b?(f.val(m),f.caret(0,v()),!1):void 0}function s(a){var b=a.which,c=f.caret();if(a.ctrlKey||a.altKey||a.metaKey||32>b)return!0;if(b){0!=c.end-c.begin&&(t(c.begin,c.end),p(c.begin,c.end-1));var d=n(c.begin-1);if(k>d){var g=String.fromCharCode(b);if(h[d].test(g)){q(d),l[d]=g,u();var i=n(d);f.caret(i),e.completed&&i>=k&&e.completed.call(f)}}return!1}}function t(a,b){for(var c=a;b>c&&k>c;c++)h[c]&&(l[c]=e.placeholder)}function u(){return f.val(l.join("")).val()}function v(a){for(var b=f.val(),c=-1,d=0,g=0;k>d;d++)if(h[d]){for(l[d]=e.placeholder;g++<b.length;){var m=b.charAt(g-1);if(h[d].test(m)){l[d]=m,c=d;break}}if(g>b.length)break}else l[d]==b.charAt(g)&&d!=i&&(g++,c=d);return!a&&i>c+1?(f.val(""),f.addClass("empty"),t(0,k)):(a||c+1>=i)&&(u(),a||f.val(f.val().substring(0,c+1))),i?d:j}var f=a(this),l=a.map(d.split(""),function(a){return"?"!=a?g[a]?e.placeholder:a:void 0}),m=f.val();f.data(a.mask.dataName,function(){return a.map(l,function(a,b){return h[b]&&a!=e.placeholder?a:null}).join("")}),f.attr("readonly")||f.one("unmask",function(){f.unbind(".mask").removeData(a.mask.dataName)}).bind("focus.mask",function(){m=f.val();var b=v();u();var c=function(){b==d.length?f.caret(0,b):f.caret(b)};(a("html").hasClass("no-ie")?function(){setTimeout(c,0)}:c)()}).bind("blur.mask",function(){v(),f.val()!=m&&f.change()}).bind("keydown.mask",r).bind("keypress.mask",s).bind(b,function(){setTimeout(function(){f.caret(v(!0))},0)}),v()})}})}(jQuery);